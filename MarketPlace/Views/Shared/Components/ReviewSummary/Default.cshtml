@using MarketPlace.ViewComponents.ReviewSummaryViewComponent
@model ReviewSummaryViewModel

<div class="card p-4">
    <h4 class="card-title mb-4">Reviews Summary</h4>
    <div class="review-summary">
        <div class="d-flex align-items-center mb-4">
            <!-- Average Rating -->
            <div class="me-4 text-center">
                <h3 class="display-6 fw-bold mb-0">@Model.AverageRating.ToString("0.0")</h3>
                <div class="mb-2">
                    @for (var i = 1; i <= 5; i++)
                    {
                        if (i <= Math.Floor(Model.AverageRating))
                        {
                            <i class="bi bi-star-fill text-warning"></i>
                        }
                        else if (i - Model.AverageRating <= 0.5)
                        {
                            <i class="bi bi-star-half text-warning"></i>
                        }
                        else
                        {
                            <i class="bi bi-star text-warning"></i>
                        }
                    }
                </div>
                <p class="text-muted small mb-0">@Model.TotalReviews reviews</p>
            </div>

            <!-- Rating Breakdown -->
            <div class="flex-grow-1">
                @for (int rating = 5; rating >= 1; rating--)
                {
                    var count = Model.RatingBreakdown.ContainsKey(rating) ? Model.RatingBreakdown[rating] : 0;
                    var percentage = Model.TotalReviews > 0 ? (count * 100.0 / Model.TotalReviews) : 0;

                    <div class="d-flex align-items-center mb-2">
                        <div class="text-muted small me-2" style="width: 20px;">@rating</div>
                        <i class="bi bi-star-fill text-warning me-2 small"></i>
                        <div class="progress flex-grow-1" style="height: 8px;">
                            <div class="progress-bar bg-warning" style="width: @Math.Floor(percentage)%"></div>
                        </div>
                        <span class="text-muted small ms-2">@count</span>
                    </div>
                    
                }
            </div>
        </div>
    </div>
</div>